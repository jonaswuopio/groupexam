---
title: "Image filter group 6 examn"
author: "Jonas Wuopio"
date: "Sys.Date()"
output: pdf_document
---


```{r "load image and convert to bitmap"}

library(magick)

# Path to the image
image_path <- "C:/Users/jonwuo/OneDrive - Karolinska Institutet/Dokument/Forskning/Kurser/Inermediate R/Group exam/Testimage.jpg"

#load image into environment
image_bitmap <- image_read(image_path)

#Turn jpeg into bitmap to be able to
image_bitmap <- image_bitmap[[1]]

```

```{r "greyscale filter"}

greyscale_filter <- function(rgb) {
  
  greyscale_value <- round(rgb[1] * 0.299 + rgb[2] * 0.587 + rgb[3] * 0.114)
  
  return(as.raw(c(greyscale_value, greyscale_value, greyscale_value)))
}


```

```{r "applying the filter to the image"}

apply_greyscale_filter <- function(image) {

  # Copy of the image to store filtered values
  filtered_image <- image
  
  # Loop through each pixel in the image
  for (row in 1:dim(image)[3]) {
    
      for (col in 1:dim(image)[2]) {
      
        # Extract RGB values for the current pixel
        R <- as.numeric(image[1, col, row])
        G <- as.numeric(image[2, col, row])
        B <- as.numeric(image[3, col, row])
      
        # Apply the greyscale filter function to the RGB-vector
        greyscale_pixel <- greyscale_filter(c(R, G, B))
      
        # Update the filtered bitmap
        filtered_image[1, col, row] <- as.raw(greyscale_pixel[1])
        filtered_image[2, col, row] <- as.raw(greyscale_pixel[2])
        filtered_image[3, col, row] <- as.raw(greyscale_pixel[3])
    }
  }
  return(filtered_image)
}
  
```

```{r "control the function"}

image_read(apply_greyscale_filter(image_bitmap))


```

